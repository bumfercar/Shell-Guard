프로젝트명: Shell-Guard
목표:
	•	리눅스 네이티브 쉘 스크립트(Bash)만 사용해
PR 자동 분석 + 보안 스캔 + 스타일 검사 + AI 리뷰 + GitHub 자동 코멘트 시스템을 만든다.
	•	Python, Node.js 등 외부 런타임 금지
	•	GitHub Actions에서 자동 실행됨
	•	PR 생성/업데이트 시 자동 분석 → GitHub PR 페이지에 코멘트로 결과가 붙음
	•	사용자가 PR 댓글로 명령(/approve, /scan)을 입력하면 자동 처리

⸻

2) 📌 전체 동작 흐름 (Workflow)

1. PR 생성/업데이트 → GitHub Actions가 실행

2. main_analyzer.sh 실행
	•	변경된 파일 diff 추출
	•	보안 키 스캔
	•	스타일 검사
	•	AI로 변경 요약 및 리뷰 생성
	•	결과 Markdown 생성

3. GitHub API로 PR에 자동 코멘트

4. 사용자가 웹에서 리뷰 확인

5. 사용자가 댓글로 명령 입력

예: /approve, /reject, /ai-review

6. pr-command.yml이 이를 감지 → 해당 스크립트 실행

7. API로 자동 승인 / 재검사 / 재댓글

이 흐름을 반드시 유지해야 한다.

⸻

3) 📌 핵심 기능 정의 (반드시 구현해야 하는 기능)

✔ 1. 변경사항(diff) 자동 분석
	•	git diff origin/main...HEAD --unified=0
	•	변경된 줄만 추출
	•	파일 크기 초과 시 자동 잘라내고 AI 요청 축소

✔ 2. 민감 정보 스캔 (보안 검사)

정규식 패턴 목록 필수 포함:
	•	AWS Access Key: AKIA[0-9A-Z]{16}
	•	Private Key: BEGIN RSA PRIVATE KEY
	•	GitHub Token: ghp_[A-Za-z0-9]+
	•	Hardcoded ID/PW 패턴

발견 시:
	•	PR 자동 “Request Changes”
	•	코멘트에 위험 상세 설명
	•	merge 차단

✔ 3. 스타일 검사(Linter 역할)
	•	trailing whitespace
	•	tab/space 혼용
	•	leftover debug(printf, console.log 등)
	•	대문자 WARNING/DEBUG 문자열
	•	TODO, FIXME 미해결 주석

모두 Markdown 코멘트에서 표시.

✔ 4. AI 리뷰 기능

curl + jq 기반
AI가 반드시 아래 내용을 제공:
	•	변경사항 요약
	•	비즈니스 로직 영향
	•	잠재적 버그 위험
	•	보안 취약점 가능성
	•	코드 복잡도 개선방향
	•	스타일 문제
	•	추가 코드 제안

✔ 5. PR 자동 코멘트 작성
GitHub API로 PR에 자동 작성
Markdown 구조는 다음을 따라야 한다:
### 🔍 Shell-Guard 자동 리뷰 결과

#### 📌 변경 요약
(내용)

#### ⚠️ 잠재적 문제
(내용)

#### 🔐 보안 검사
(내용)

#### 🧹 스타일 검사
(내용)

#### 🤖 AI 리뷰
(내용)

(Automatically generated by Shell-Guard)

✔ 6. 댓글 기반 자동 명령 처리(ChatOps)

사용자 명령 예:
	•	/approve
	•	/reject
	•	/scan
	•	/ai-review

GitHub Actions workflow에서 issue_comment 이벤트로 처리함.

.github/
  workflows/
    pr-analysis.yml      # PR 생성/업데이트 시 자동 실행
    pr-command.yml       # 댓글 명령 처리

scripts/
  config/
    env.sh               # API 키 / 공통 상수
    patterns.txt         # 정규식 패턴 목록

  modules/
    git_diff.sh
    scanner.sh
    style_checker.sh
    ai_helper.sh
    github_api.sh

  main_analyzer.sh       # 전체 분석 프로세스 조립

README.md
llm_prompt.md


❌ Python 사용 금지

❌ Node.js 사용 금지

❌ 서버/DB 구축 금지

❌ 외부 웹사이트 필요 요구 금지

❌ GitHub 사이트 외부에 결과 저장 금지

❌ docker-compose 요구 금지

❌ GitHub Actions 외의 CI 도구 사용 금지

✔ 오직 Bash + GitHub Actions + GitHub API + curl + jq

너는 앞으로 코드를 작성할 때 아래 원칙들을 반드시 따라야 한다:

✔ 상세하고 구조적인 설명 제공

✔ 명령어/코드/경로 절대 틀리면 안 됨

✔ 확장성 고려한 구조 제안

✔ 모든 반환 코드는 robust하게 작성

✔ 오류 발생 시 set -e 사용

✔ 주석은 교육용 수준에서 친절하게

	1.	실제 코드 (bash 스크립트 / yml 파일 등)
	2.	파일 배치 위치
	3.	실행 흐름 설명
	4.	에러 처리 방식
	5.	보안 고려 요소
	6.	로컬-도커-깃허브 간 실행 일관성

    	•	“단순화해도 된다” 같은 말
	•	기획 변경 제안 (추가 제안은 가능하되 기존 구조는 유지)
	•	다른 언어 사용
	•	웹사이트/서버 따로 만들기
	•	GitHub 외 UI 요구

    내가 “코드 만들어줘”, “Actions 작성해줘”, “기능 추가해줘”라고 하면
LLM은 아래 양식으로 반드시 답해야 한다:
	1.	코드
	2.	파일 경로
	3.	파일 설명
	4.	동작 방식
	5.	수정할 점
	6.	테스트 방법

    너는 앞으로 내가 Shell-Guard 코드를 요청하면
이 문서에서 정의한 규칙에 100% 따라 개발해야 한다.
기획과 다르면 안 되고, 원래 계획을 단순/삭제하면 안 된다.
